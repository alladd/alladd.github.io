<html>
<head>
<script type="text/javascript" src="../node_modules/bignumber.js/bignumber.min.js"></script>
<script src="https://cdn.rawgit.com/ethereum/web3.js/develop/dist/web3.js"></script>
<!-- script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script -->
<script type="text/javascript">


      window.addEventListener('load', function() {

      // Checking if Web3 has been injected by the browser (Mist/MetaMask)
      if (typeof web3 !== 'undefined') {
      // Use Mist/MetaMask's provider
      window.web3 = new Web3(web3.currentProvider);
      } else {
      console.log('No web3? You should consider trying MetaMask!')
      // fallback - use your fallback strategy (local node / hosted node + in-dapp id mgmt / fail)
      window.web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
      }
      // Now you can start your app & access web3 freely:
      });

     function watchBalance() {
         var coinbase = web3.eth.coinbase;

         var originalBalance = web3.eth.getBalance(coinbase).toNumber();
         document.getElementById('coinbase').innerText = 'coinbase: ' + coinbase;
         document.getElementById('original').innerText = ' original balance: ' + originalBalance + '    watching...';

         web3.eth.filter('latest').watch(function() {
             var currentBalance = web3.eth.getBalance(coinbase).toNumber();
             document.getElementById("current").innerText = 'current: ' + currentBalance;
             document.getElementById("diff").innerText = 'diff:    ' + (currentBalance - originalBalance);
         });
     }

 </script>
 </head>
 <body>
     <h1>coinbase balance</h1>
     <button type="button" onClick="watchBalance();">watch balance</button>
     <div></div>
     <div id="coinbase"></div>
     <div id="original"></div>
     <div id="current"></div>
     <div id="diff"></div>
 </body>
 </html>
